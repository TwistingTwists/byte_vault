"use strict";(self.webpackChunkbytevault=self.webpackChunkbytevault||[]).push([[6235],{2680:(e,t,a)=>{a.r(t),a.d(t,{assets:()=>c,contentTitle:()=>o,default:()=>m,frontMatter:()=>d,metadata:()=>s,toc:()=>u});var s=a(2125),n=a(4848),i=a(8453),r=a(1096),l=a(7545);const d={slug:"database-isolation-visualised-dirty-reads",title:"Database Isolation (dirty reads)",date:new Date("2025-04-21T00:00:00.000Z"),authors:["abeeshake"],tags:["databases","transactions"],draft:!1},o=void 0,c={authorsImageUrls:[void 0]},u=[{value:"Understanding Dirty Reads: A Database Isolation Problem",id:"understanding-dirty-reads-a-database-isolation-problem",level:2},{value:"What is a Dirty Read?",id:"what-is-a-dirty-read",level:3},{value:"Example Scenario",id:"example-scenario",level:3},{value:"Initial Database State",id:"initial-database-state",level:4},{value:"Step-by-Step: Dirty Read in Action",id:"step-by-step-dirty-read-in-action",level:3},{value:"1. T1 Reads the Original Value",id:"1-t1-reads-the-original-value",level:4},{value:"2. T2 Updates the Value (But Doesn&#39;t Commit)",id:"2-t2-updates-the-value-but-doesnt-commit",level:4},{value:"3. T1 Reads Again (Dirty Read!)",id:"3-t1-reads-again-dirty-read",level:4},{value:"4. T2 Commits",id:"4-t2-commits",level:4},{value:"5. T1 Commits",id:"5-t1-commits",level:4},{value:"Why is This a Problem?",id:"why-is-this-a-problem",level:2},{value:"Visualizing the Dirty Read",id:"visualizing-the-dirty-read",level:2},{value:"Conclusion",id:"conclusion",level:2}];function h(e){const t={br:"br",code:"code",h2:"h2",h3:"h3",h4:"h4",hr:"hr",li:"li",p:"p",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,i.R)(),...e.components};return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(r.A,{toc:u}),"\n","\n",(0,n.jsx)(t.h2,{id:"understanding-dirty-reads-a-database-isolation-problem",children:"Understanding Dirty Reads: A Database Isolation Problem"}),"\n",(0,n.jsx)(t.h3,{id:"what-is-a-dirty-read",children:"What is a Dirty Read?"}),"\n",(0,n.jsxs)(t.p,{children:["A ",(0,n.jsx)(t.strong,{children:"dirty read"}),' occurs when a transaction reads data that has been written by another transaction but not yet committed. If the writing transaction rolls back, the data read by the first transaction becomes invalid\u2014hence, "dirty."']}),"\n",(0,n.jsx)(t.p,{children:"This can lead to inconsistent or incorrect results in applications, especially in systems where multiple users or processes are accessing and modifying the data concurrently."}),"\n","\n",(0,n.jsx)(t.hr,{}),"\n",(0,n.jsx)(t.h3,{id:"example-scenario",children:"Example Scenario"}),"\n",(0,n.jsx)(t.p,{children:"Let's walk through a concrete example to see how a dirty read can happen."}),"\n",(0,n.jsx)(t.h4,{id:"initial-database-state",children:"Initial Database State"}),"\n",(0,n.jsx)(t.p,{children:"Suppose we have a simple database table:"}),"\n",(0,n.jsxs)(t.table,{children:[(0,n.jsx)(t.thead,{children:(0,n.jsxs)(t.tr,{children:[(0,n.jsx)(t.th,{children:"key"}),(0,n.jsx)(t.th,{children:"value"})]})}),(0,n.jsxs)(t.tbody,{children:[(0,n.jsxs)(t.tr,{children:[(0,n.jsx)(t.td,{children:"name"}),(0,n.jsx)(t.td,{children:"abhishek"})]}),(0,n.jsxs)(t.tr,{children:[(0,n.jsx)(t.td,{children:"age"}),(0,n.jsx)(t.td,{children:"42"})]})]})]}),"\n",(0,n.jsxs)(t.p,{children:["Two transactions, ",(0,n.jsx)(t.strong,{children:"T1"})," and ",(0,n.jsx)(t.strong,{children:"T2"}),", will interact with the ",(0,n.jsx)(t.code,{children:"name"})," row."]}),"\n",(0,n.jsx)(t.hr,{}),"\n",(0,n.jsx)(t.h3,{id:"step-by-step-dirty-read-in-action",children:"Step-by-Step: Dirty Read in Action"}),"\n",(0,n.jsx)(t.h4,{id:"1-t1-reads-the-original-value",children:"1. T1 Reads the Original Value"}),"\n",(0,n.jsxs)(t.ul,{children:["\n",(0,n.jsxs)(t.li,{children:[(0,n.jsx)(t.strong,{children:"T1"})," starts and reads the value of ",(0,n.jsx)(t.code,{children:"name"}),"."]}),"\n",(0,n.jsxs)(t.li,{children:["It sees:",(0,n.jsx)(t.br,{}),"\n",(0,n.jsx)(t.code,{children:"name = 'abhishek'"})," (the committed value)."]}),"\n"]}),"\n",(0,n.jsx)(t.h4,{id:"2-t2-updates-the-value-but-doesnt-commit",children:"2. T2 Updates the Value (But Doesn't Commit)"}),"\n",(0,n.jsxs)(t.ul,{children:["\n",(0,n.jsxs)(t.li,{children:[(0,n.jsx)(t.strong,{children:"T2"})," starts and updates ",(0,n.jsx)(t.code,{children:"name"})," to ",(0,n.jsx)(t.code,{children:"'john'"}),"."]}),"\n",(0,n.jsxs)(t.li,{children:["This change is ",(0,n.jsx)(t.strong,{children:"not yet committed"})," to the database."]}),"\n",(0,n.jsx)(t.li,{children:"Other transactions should ideally not see this uncommitted value."}),"\n"]}),"\n",(0,n.jsx)(t.h4,{id:"3-t1-reads-again-dirty-read",children:"3. T1 Reads Again (Dirty Read!)"}),"\n",(0,n.jsxs)(t.ul,{children:["\n",(0,n.jsxs)(t.li,{children:[(0,n.jsx)(t.strong,{children:"T1"})," reads the value of ",(0,n.jsx)(t.code,{children:"name"})," again."]}),"\n",(0,n.jsxs)(t.li,{children:[(0,n.jsxs)(t.strong,{children:["Because the database isolation level is low (e.g., READ UNCOMMITTED), T1 sees ",(0,n.jsx)(t.code,{children:"name = 'john'"})]}),", even though T2 hasn't committed."]}),"\n",(0,n.jsxs)(t.li,{children:["This is a ",(0,n.jsx)(t.strong,{children:"dirty read"}),": T1 is reading data that might be rolled back."]}),"\n"]}),"\n",(0,n.jsx)(t.h4,{id:"4-t2-commits",children:"4. T2 Commits"}),"\n",(0,n.jsxs)(t.ul,{children:["\n",(0,n.jsxs)(t.li,{children:[(0,n.jsx)(t.strong,{children:"T2"})," now commits its change."]}),"\n",(0,n.jsxs)(t.li,{children:[(0,n.jsx)(t.code,{children:"name = 'john'"})," is now the official, permanent value."]}),"\n"]}),"\n",(0,n.jsx)(t.h4,{id:"5-t1-commits",children:"5. T1 Commits"}),"\n",(0,n.jsxs)(t.ul,{children:["\n",(0,n.jsxs)(t.li,{children:[(0,n.jsx)(t.strong,{children:"T1"})," commits, possibly basing its logic on the dirty value it read earlier."]}),"\n"]}),"\n",(0,n.jsx)(t.hr,{}),"\n",(0,n.jsx)(t.h2,{id:"why-is-this-a-problem",children:"Why is This a Problem?"}),"\n",(0,n.jsxs)(t.p,{children:["If ",(0,n.jsx)(t.strong,{children:"T2"})," had rolled back instead of committing, ",(0,n.jsx)(t.strong,{children:"T1"})," would have read a value that never officially existed in the database. This can cause application bugs, data corruption, or security issues."]}),"\n",(0,n.jsx)(t.hr,{}),"\n",(0,n.jsx)(t.h2,{id:"visualizing-the-dirty-read",children:"Visualizing the Dirty Read"}),"\n",(0,n.jsx)(t.p,{children:"The animation below demonstrates this scenario step-by-step. You can see how the database and transactions interact, and exactly when the dirty read occurs."}),"\n",(0,n.jsx)(l.A,{}),"\n",(0,n.jsx)(t.hr,{}),"\n",(0,n.jsx)(t.h2,{id:"conclusion",children:"Conclusion"}),"\n",(0,n.jsx)(t.p,{children:"Dirty reads are a classic example of why database isolation levels matter. By default, most production databases avoid dirty reads by using stricter isolation (like READ COMMITTED or higher). However, understanding this scenario helps you appreciate the trade-offs between performance and consistency in concurrent systems."})]})}function m(e={}){const{wrapper:t}={...(0,i.R)(),...e.components};return t?(0,n.jsx)(t,{...e,children:(0,n.jsx)(h,{...e})}):h(e)}},7545:(e,t,a)=>{a.d(t,{A:()=>r});var s=a(6540),n=a(4685),i=a(4848);const r=()=>{const[e,t]=(0,s.useState)({isRunning:!1,isPaused:!1,currentStep:0,totalSteps:7,speed:1}),[a,r]=(0,s.useState)({dbData:{key:"name",committedValue:"abhishek",uncommittedValue:null,writerTx:null},transaction1:{status:"idle",lastReadValue:null,isDirtyRead:!1},transaction2:{status:"idle",lastReadValue:null,isDirtyRead:!1}}),[l,d]=(0,s.useState)("Ready to visualize Dirty Read."),o=(0,s.useRef)(null),c=(0,s.useRef)(null),u=(0,s.useRef)(null),h=(0,s.useRef)({play:!1,step:!1,reset:!1}),m=[{action:()=>(x(),"Initial State: Database 'name' = 'abhishek'. Transactions Idle.")},{action:()=>(r((e=>({...e,transaction1:{...e.transaction1,status:"holding_read",lastReadValue:e.dbData.committedValue}}))),`T1: Reads 'name'. Value = '${a.dbData.committedValue}' (Committed).`)},{action:()=>(r((e=>({...e,transaction2:{...e.transaction2,status:"writing"}}))),"T2: Begins writing 'john' to 'name'.")},{action:()=>(r((e=>({...e,dbData:{...e.dbData,uncommittedValue:"john",writerTx:"T2"},transaction2:{...e.transaction2,status:"holding_uncommitted_write"}}))),"T2: Finishes writing. 'name' now has uncommitted value 'john'.")},{action:()=>{const e=a.dbData.uncommittedValue??a.dbData.committedValue,t=null!==a.dbData.uncommittedValue;r((a=>({...a,transaction1:{...a.transaction1,status:t?"error_dirty_read":"holding_read",lastReadValue:e,isDirtyRead:t}})));const s=`T1: Reads 'name' again. Value = '${e}'.`;return t?`${s} *** DIRTY READ! *** (Reading uncommitted data from T2)`:`${s} (Committed)`}},{action:()=>(r((e=>({...e,dbData:{...e.dbData,committedValue:e.dbData.uncommittedValue??e.dbData.committedValue,uncommittedValue:null,writerTx:null},transaction2:{...e.transaction2,status:"committed"}}))),"T2: Commits the write. 'name' is now permanently 'john'.")},{action:()=>(r((e=>({...e,transaction1:{...e.transaction1,status:"committed",isDirtyRead:!1}}))),`T1: Commits. (Note: T1's logic might have been based on the dirty value '${a.transaction1.lastReadValue}')`)},{action:()=>(t((e=>({...e,isRunning:!1,isPaused:!1}))),"Simulation Complete. Final committed value for 'name' is 'john'.")}],x=(0,s.useCallback)((()=>{t((e=>({...e,isRunning:!1,isPaused:!1,currentStep:0})));const e={status:"idle",lastReadValue:null,isDirtyRead:!1};r({dbData:{key:"name",committedValue:"abhishek",uncommittedValue:null,writerTx:null},transaction1:{...e},transaction2:{...e}}),d("Simulation Reset. Ready to visualize Dirty Read.")}),[]),b=(e,t)=>{if(!h.current[t]){const a=e.current;if(a){const e=a.getBoundingClientRect(),s=(e.left+e.width/2)/window.innerWidth,i=(e.top+e.height/2)/window.innerHeight;(0,n.A)({particleCount:100,spread:70,origin:{x:s,y:i},colors:["#22c55e","#3b82f6","#64748b","#ef4444","#a855f7"]}),h.current[t]=!0}}},g=(0,s.useCallback)((()=>{const{currentStep:a,totalSteps:s}=e;if(a<s)if(m[a]){const e=m[a].action();d(e||`Executing step ${a+1}...`),t((e=>({...e,currentStep:e.currentStep+1})))}else console.error("Animation step not found:",a),t((e=>({...e,isRunning:!1})));else e.isRunning&&t((e=>({...e,isRunning:!1,isPaused:!1})))}),[e,m]),p=(0,s.useCallback)((()=>{b(o,"play"),e.currentStep>=e.totalSteps?(x(),setTimeout((()=>{t((e=>({...e,isRunning:!0,isPaused:!1}))),g()}),100)):(t((e=>({...e,isRunning:!0,isPaused:!1}))),g())}),[e.currentStep,e.totalSteps,x,g]),y=(0,s.useCallback)((()=>{t((e=>({...e,isRunning:!1,isPaused:!0})))}),[]),j=(0,s.useCallback)((()=>{b(c,"step"),!e.isRunning&&e.currentStep<e.totalSteps&&(t((e=>({...e,isPaused:!0}))),g())}),[e.isRunning,e.currentStep,e.totalSteps,g]),w=(0,s.useCallback)((()=>{b(u,"reset"),x()}),[x]),f=(0,s.useCallback)((e=>{t((t=>({...t,speed:parseFloat(e.target.value)})))}),[]),v=()=>{const t=m.length,a=e.currentStep,[n,r]=(0,s.useState)(!0);(0,s.useEffect)((()=>{const e=setTimeout((()=>{r(!1)}),5e3);return()=>clearTimeout(e)}),[]);const l=[{step:0,tx:null,action:"Initial State",position:0},{step:1,tx:"T1",action:"Read",position:1},{step:2,tx:"T2",action:"Begin Write",position:2},{step:3,tx:"T2",action:"Write (Uncommitted)",position:3},{step:4,tx:"T1",action:"Dirty Read",position:4,highlight:!0},{step:5,tx:"T2",action:"Commit",position:5},{step:6,tx:"T1",action:"Commit",position:6},{step:7,tx:null,action:"Final State",position:7}];return(0,i.jsxs)("div",{className:"w-full mt-2 mb-6 px-6 py-4 bg-gray-800/90 backdrop-blur-sm rounded-lg shadow-md border border-gray-700",children:[(0,i.jsx)("h3",{className:"text-xl font-bold text-white mb-4 pb-2 border-b border-gray-600/50",children:"Transaction Timeline"}),(0,i.jsxs)("div",{className:"flex flex-wrap justify-center items-center gap-4 mb-4 text-xs text-white/90 transition-all duration-300 \n          "+(n?"opacity-100 -translate-y-0":"opacity-0 translate-y-2"),children:[(0,i.jsxs)("div",{className:"flex items-center gap-2 px-2 py-1 rounded-md bg-gray-800/30 border border-gray-700/30",children:[(0,i.jsx)("div",{className:"w-2.5 h-2.5 rounded-full bg-cyan-500 shadow-[0_0_6px_0_rgba(34,211,238,0.4)]"}),(0,i.jsx)("span",{children:"T1 Events"})]}),(0,i.jsxs)("div",{className:"flex items-center gap-2 px-2 py-1 rounded-md bg-gray-800/30 border border-gray-700/30",children:[(0,i.jsx)("div",{className:"w-2.5 h-2.5 rounded-full bg-orange-500 shadow-[0_0_6px_0_rgba(249,115,22,0.4)]"}),(0,i.jsx)("span",{children:"T2 Events"})]}),(0,i.jsxs)("div",{className:"flex items-center gap-2 px-2 py-1 rounded-md bg-gray-800/30 border border-gray-700/30",children:[(0,i.jsx)("div",{className:"w-2.5 h-2.5 rounded-full bg-yellow-500 shadow-[0_0_6px_0_rgba(234,179,8,0.4)]"}),(0,i.jsx)("span",{children:"Dirty Read"})]}),(0,i.jsxs)("div",{className:"flex items-center gap-2 px-2 py-1 rounded-md bg-gray-800/30 border border-gray-700/30",children:[(0,i.jsx)("div",{className:"w-2.5 h-2.5 rounded-full bg-indigo-500 shadow-[0_0_6px_0_rgba(99,102,241,0.4)]"}),(0,i.jsx)("span",{children:"System Events"})]}),(0,i.jsxs)("div",{className:"flex items-center gap-2 px-2 py-1 rounded-md bg-gray-800/30 border border-gray-700/30",children:[(0,i.jsx)("div",{className:"w-2.5 h-2.5 rounded-full bg-white ring-1 ring-white/30"}),(0,i.jsx)("span",{children:"Current Step"})]})]}),(0,i.jsxs)("div",{className:"relative h-52 bg-gray-900/50 backdrop-blur rounded-xl border border-gray-700/50 overflow-hidden px-8 py-6 mx-4 my-2 group",onMouseEnter:()=>r(!0),onMouseLeave:()=>r(!1),children:[(0,i.jsx)("div",{className:"absolute top-1/2 left-16 right-16 h-[2px] bg-gray-700/50 rounded-full"}),(0,i.jsx)("div",{className:"absolute top-1/3 left-16 right-16 h-[2px] bg-gray-700/30"}),(0,i.jsx)("div",{className:"absolute top-2/3 left-16 right-16 h-[2px] bg-gray-700/30"}),(()=>{const e=l.filter((e=>"T1"===e.tx)),s=l.filter((e=>"T2"===e.tx)),n=e=>{for(let s=e.length-1;s>=0;s--)if(e[s].step<a){return e[s].position/(t-1)*100+"%"}return"0%"};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)("div",{className:"absolute top-1/3 left-16 h-[2px] bg-cyan-500/50 backdrop-blur transition-all duration-300 shadow-[0_0_8px_0_rgba(34,211,238,0.4)]",style:{width:n(e)}}),(0,i.jsx)("div",{className:"absolute top-2/3 left-16 h-[2px] bg-orange-500/50 backdrop-blur transition-all duration-300 shadow-[0_0_8px_0_rgba(249,115,22,0.4)]",style:{width:n(s)}})]})})(),(0,i.jsx)("div",{className:"absolute top-1/3 left-6 -translate-y-1/2 text-sm font-medium text-cyan-400/90 px-2 py-1 rounded-md bg-cyan-950/30 border border-cyan-500/20 shadow-sm",children:"T1"}),(0,i.jsx)("div",{className:"absolute top-2/3 left-6 -translate-y-1/2 text-sm font-medium text-orange-400/90 px-2 py-1 rounded-md bg-orange-950/30 border border-orange-500/20 shadow-sm",children:"T2"}),l.map(((e,s)=>{const n=16+e.position/t*68+"%",r=a>e.step,l=a===e.step;let d="50%";"T1"===e.tx&&(d="33.333%"),"T2"===e.tx&&(d="66.667%");let o="bg-gray-500",c="";return"T1"===e.tx?(o=r?"bg-cyan-500":"bg-cyan-800/50",c="shadow-[0_0_8px_0_rgba(34,211,238,0.4)]",e.highlight&&(o=r?"bg-yellow-500":"bg-yellow-800/50",c="shadow-[0_0_8px_0_rgba(234,179,8,0.4)]")):"T2"===e.tx?(o=r?"bg-orange-500":"bg-orange-800/50",c="shadow-[0_0_8px_0_rgba(249,115,22,0.4)]"):(o=r?"bg-indigo-500":"bg-indigo-800/50",c="shadow-[0_0_8px_0_rgba(99,102,241,0.4)]"),l&&(o=o.replace("500","400").replace("800","600")),(0,i.jsxs)("div",{className:"absolute transform -translate-x-1/2 -translate-y-1/2 flex flex-col items-center",style:{left:n,top:d},children:[(0,i.jsx)("div",{className:`w-4 h-4 rounded-full ${o} ${c} ${l?"ring-2 ring-white/30 scale-125":""} shadow-md flex items-center justify-center backdrop-blur-sm transition-all duration-300`,children:l&&(0,i.jsx)("div",{className:"w-2 h-2 rounded-full bg-white animate-pulse"})}),(0,i.jsx)("div",{className:`absolute whitespace-nowrap text-xs font-medium text-white px-2.5 py-1.5 rounded-lg \n                  ${"33.333%"===d?"bottom-7":"top-7"} \n                  ${o.replace("bg-","bg-")}/10 backdrop-blur-sm \n                  border border-gray-700/30 shadow-lg \n                  ${l?"font-bold scale-105":""} \n                  transition-all duration-300`,children:e.action}),e.tx&&(0,i.jsx)("div",{className:`absolute h-16 w-[1px] ${o.replace("bg-","bg-")}/30 backdrop-blur-sm`,style:{top:"33.333%"===d?"0%":"-100%"}})]},s)}))]})]})},T=()=>{const{dbData:t,transaction1:s,transaction2:n}=a,r=(e.currentStep,s.status),d=n.status,o=s.isDirtyRead;return(0,i.jsxs)("div",{className:"w-full mt-2 mb-6 px-6 py-4 bg-gray-800/90 backdrop-blur-sm rounded-lg shadow-md border border-gray-700",children:[(0,i.jsx)("div",{className:"flex justify-center mb-8",children:(0,i.jsxs)("div",{className:"relative bg-gray-900 rounded-lg border border-gray-600 p-6 w-full max-w-md shadow-lg",children:[(0,i.jsx)("div",{className:"absolute -top-3 left-1/2 transform -translate-x-1/2 bg-blue-600 text-white px-3 py-1 rounded-md text-sm font-bold",children:"Database"}),(0,i.jsxs)("table",{className:"w-full text-white border-collapse",children:[(0,i.jsx)("thead",{children:(0,i.jsxs)("tr",{children:[(0,i.jsx)("th",{className:"border-b border-gray-700 py-2 text-left w-1/3",children:"Key"}),(0,i.jsx)("th",{className:"border-b border-gray-700 py-2 text-left w-2/3",children:"Value"})]})}),(0,i.jsxs)("tbody",{children:[(0,i.jsxs)("tr",{children:[(0,i.jsx)("td",{className:"py-2 font-mono",children:t.key}),(0,i.jsxs)("td",{className:"py-2 font-mono flex items-center gap-2",children:[(0,i.jsx)("span",{className:"text-blue-400 whitespace-nowrap",children:t.committedValue}),(0,i.jsx)("span",{className:"text-xs text-blue-300 whitespace-nowrap",children:"(committed)"})]})]}),t.uncommittedValue&&(0,i.jsxs)("tr",{className:"bg-red-900/20",children:[(0,i.jsx)("td",{className:"py-2 font-mono",children:t.key}),(0,i.jsxs)("td",{className:"py-2 font-mono flex items-center gap-2",children:[(0,i.jsx)("span",{className:"text-red-400 whitespace-nowrap",children:t.uncommittedValue}),(0,i.jsxs)("span",{className:"text-xs text-red-300 whitespace-nowrap",children:["(uncommitted by ",t.writerTx,")"]})]})]})]})]})]})}),(0,i.jsx)("div",{className:"w-full max-w-4xl mb-4 p-4 bg-gray-800/90 backdrop-blur-sm rounded-lg shadow-md text-center border border-gray-700 mx-auto",children:(0,i.jsxs)("p",{className:"font-medium text-white text-lg leading-tight",children:[(0,i.jsx)("span",{className:"font-bold text-indigo-300",children:"Status:"})," ",l,(0,i.jsxs)("span",{className:"ml-6 text-gray-300 text-base",children:["(Step: ",e.currentStep,"/",e.totalSteps,")"]})]})}),(0,i.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[(0,i.jsxs)("div",{className:`relative bg-gray-900 rounded-lg border ${o?"border-yellow-500":"border-gray-600"} p-4 shadow-lg`,children:[(0,i.jsx)("div",{className:`absolute -top-3 left-4 ${o?"bg-yellow-500":"bg-cyan-600"} text-white px-3 py-1 rounded-md text-sm font-bold`,children:"Transaction 1"}),(0,i.jsxs)("div",{className:"mt-3",children:[(0,i.jsxs)("div",{className:"flex justify-between mb-2",children:[(0,i.jsx)("span",{className:"text-gray-400",children:"Status:"}),(0,i.jsx)("span",{className:`font-medium ${R(r)}`,children:N(r)})]}),s.lastReadValue&&(0,i.jsxs)("div",{className:"flex justify-between",children:[(0,i.jsx)("span",{className:"text-gray-400",children:"Last Read:"}),(0,i.jsxs)("span",{className:"font-mono "+(o?"text-yellow-400":"text-white"),children:["'",s.lastReadValue,"'",o&&(0,i.jsx)("span",{className:"ml-1 text-xs text-yellow-300",children:"(dirty!)"})]})]}),o&&(0,i.jsxs)("div",{className:"mt-3 p-2 bg-yellow-900/30 border border-yellow-800 rounded text-yellow-300 text-sm",children:[(0,i.jsx)("span",{className:"font-bold",children:"\u26a0\ufe0f Dirty Read:"})," Reading uncommitted data from T2"]})]})]}),(0,i.jsxs)("div",{className:"relative bg-gray-900 rounded-lg border border-gray-600 p-4 shadow-lg",children:[(0,i.jsx)("div",{className:"absolute -top-3 left-4 bg-orange-600 text-white px-3 py-1 rounded-md text-sm font-bold",children:"Transaction 2"}),(0,i.jsxs)("div",{className:"mt-3",children:[(0,i.jsxs)("div",{className:"flex justify-between mb-2",children:[(0,i.jsx)("span",{className:"text-gray-400",children:"Status:"}),(0,i.jsx)("span",{className:`font-medium ${R(d)}`,children:N(d)})]}),"T2"===t.writerTx&&(0,i.jsxs)("div",{className:"flex justify-between",children:[(0,i.jsx)("span",{className:"text-gray-400",children:"Writing:"}),(0,i.jsxs)("span",{className:"font-mono text-orange-400",children:["'",t.uncommittedValue,"'"]})]}),"holding_uncommitted_write"===d&&(0,i.jsxs)("div",{className:"mt-3 p-2 bg-orange-900/30 border border-orange-800 rounded text-orange-300 text-sm",children:[(0,i.jsx)("span",{className:"font-bold",children:"\ud83d\udd12 Lock:"})," Holding write lock on '",t.key,"'"]})]})]})]})]})},N=e=>{switch(e){case"idle":return"Idle";case"reading":return"Reading";case"writing":return"Writing";case"holding_read":return"Holding Read";case"holding_uncommitted_write":return"Holding Uncommitted Write";case"committed":return"Committed";case"error_dirty_read":return"DIRTY READ ERROR";default:return e}},R=e=>{switch(e){case"idle":return"text-gray-300";case"reading":case"holding_read":return"text-cyan-400";case"writing":case"holding_uncommitted_write":return"text-orange-400";case"committed":return"text-green-400";case"error_dirty_read":return"text-yellow-400";default:return"text-white"}};return(0,i.jsxs)("div",{className:"flex flex-col items-center p-4 min-h-screen bg-gradient-to-br from-gray-800 to-indigo-900 font-sans",children:[(0,i.jsx)("h2",{className:"text-3xl font-bold mb-5 text-white shadow-sm px-4 py-1 rounded bg-black/30",children:"Concurrency Issue: Dirty Read Visualization"}),(0,i.jsx)("div",{className:"w-full max-w-4xl",children:(0,i.jsx)(T,{})}),(0,i.jsx)("div",{className:"w-full max-w-4xl",children:(0,i.jsx)(v,{})}),(0,i.jsxs)("div",{className:"w-full max-w-4xl flex flex-wrap justify-center items-center gap-3 mt-4 p-3 bg-gray-800/90 backdrop-blur-sm rounded-lg shadow-md border border-gray-700 sticky bottom-0 z-50",children:[(0,i.jsx)("button",{ref:o,onClick:p,disabled:e.isRunning&&!e.isPaused,className:"px-5 py-2 text-base bg-blue-600 text-white font-semibold rounded-md shadow hover:bg-blue-700 disabled:bg-gray-400 disabled:cursor-not-allowed transition-all duration-150 ease-in-out relative overflow-visible",children:e.currentStep>=e.totalSteps?"Replay":e.isPaused?"Resume":"Play"}),(0,i.jsx)("button",{onClick:y,disabled:!e.isRunning||e.isPaused,className:"px-5 py-2 text-base bg-yellow-500 text-white font-semibold rounded-md shadow hover:bg-yellow-600 disabled:bg-gray-400 disabled:cursor-not-allowed transition-all duration-150 ease-in-out",children:"Pause"}),(0,i.jsx)("button",{ref:c,onClick:j,disabled:e.isRunning||e.currentStep>=e.totalSteps,className:"px-5 py-2 text-base bg-green-500 text-white font-semibold rounded-md shadow hover:bg-green-600 disabled:bg-gray-400 disabled:cursor-not-allowed transition-all duration-150 ease-in-out relative overflow-visible",children:"Step Forward"}),(0,i.jsx)("button",{ref:u,onClick:w,className:"px-5 py-2 text-base bg-red-500 text-white font-semibold rounded-md shadow hover:bg-red-600 transition-all duration-150 ease-in-out relative overflow-visible",children:"Reset"}),(0,i.jsxs)("div",{className:"flex items-center gap-2 ml-4 p-2 bg-gray-700 rounded border border-gray-600",children:[(0,i.jsx)("label",{htmlFor:"speedControl",className:"text-sm font-medium text-white whitespace-nowrap",children:"Anim Speed:"}),(0,i.jsx)("input",{type:"range",id:"speedControl",min:"0.2",max:"5",step:"0.1",value:e.speed,onChange:f,className:"w-24 h-2 bg-gray-600 rounded-lg appearance-none cursor-pointer accent-blue-500"}),(0,i.jsxs)("span",{className:"text-sm font-medium text-white w-8 text-right",children:[e.speed.toFixed(1),"x"]})]})]})]})}},2125:e=>{e.exports=JSON.parse('{"permalink":"/byte_vault/database-isolation-visualised-dirty-reads","source":"@site/blog/2025-04-21-db-isolation-001.mdx","title":"Database Isolation (dirty reads)","description":"Understanding Dirty Reads: A Database Isolation Problem","date":"2025-04-21T00:00:00.000Z","tags":[{"inline":true,"label":"databases","permalink":"/byte_vault/tags/databases"},{"inline":true,"label":"transactions","permalink":"/byte_vault/tags/transactions"}],"readingTime":2.12,"hasTruncateMarker":true,"authors":[{"name":"Abhishek Tripathi","title":"Curiosity brings awareness.","url":"https://github.com/TwistingTwists","page":{"permalink":"/byte_vault/authors/abeeshake"},"socials":{"x":"https://x.com/twistin456","github":"https://github.com/TwistingTwists"},"imageURL":"https://github.com/TwistingTwists.png","key":"abeeshake"}],"frontMatter":{"slug":"database-isolation-visualised-dirty-reads","title":"Database Isolation (dirty reads)","date":"2025-04-21T00:00:00.000Z","authors":["abeeshake"],"tags":["databases","transactions"],"draft":false},"unlisted":false,"nextItem":{"title":"Understanding Eventloops (Tokio Internals)","permalink":"/byte_vault/tokio-internals-visualised"}}')}}]);