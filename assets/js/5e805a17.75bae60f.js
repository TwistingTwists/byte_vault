"use strict";(self.webpackChunkbytevault=self.webpackChunkbytevault||[]).push([[8603],{3984:(e,n,t)=>{t.r(n),t.d(n,{assets:()=>d,contentTitle:()=>o,default:()=>a,frontMatter:()=>c,metadata:()=>s,toc:()=>l});var s=t(3888),r=t(4848),i=t(8453);const c={slug:"connection-pooling-in-depth",title:"Connection Pooling - in Depth",date:new Date("2025-03-13T00:00:00.000Z"),authors:["abeeshake"],tags:["connection","database","network"],draft:!1},o=void 0,d={authorsImageUrls:[void 0]},l=[{value:"\u2705 <strong>TCP Tuning Recommendations for Reverse Proxy - Real Life Scenarios</strong>",id:"-tcp-tuning-recommendations-for-reverse-proxy---real-life-scenarios",level:3},{value:"\u2705 <strong>Legend (Quick Reference)</strong>",id:"-legend-quick-reference",level:3},{value:"\u2699\ufe0f <strong>Notes:</strong>",id:"\ufe0f-notes",level:3}];function h(e){const n={a:"a",code:"code",h3:"h3",hr:"hr",li:"li",p:"p",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,i.R)(),...e.components};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsxs)(n.p,{children:["Here\u2019s a ",(0,r.jsx)(n.strong,{children:"Markdown table"})," that maps ",(0,r.jsx)(n.strong,{children:"real-life reverse proxy scenarios"})," to recommended ",(0,r.jsx)(n.strong,{children:"TCP tuning parameters"})," for optimal performance and security:"]}),"\n",(0,r.jsx)(n.hr,{}),"\n",(0,r.jsxs)(n.h3,{id:"-tcp-tuning-recommendations-for-reverse-proxy---real-life-scenarios",children:["\u2705 ",(0,r.jsx)(n.strong,{children:"TCP Tuning Recommendations for Reverse Proxy - Real Life Scenarios"})]}),"\n",(0,r.jsxs)(n.table,{children:[(0,r.jsx)(n.thead,{children:(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.th,{children:(0,r.jsx)(n.strong,{children:"Scenario"})}),(0,r.jsx)(n.th,{children:(0,r.jsx)(n.strong,{children:"tcp_fin_timeout"})}),(0,r.jsx)(n.th,{children:(0,r.jsx)(n.strong,{children:"tcp_keepalive_time"})}),(0,r.jsx)(n.th,{children:(0,r.jsx)(n.strong,{children:"tcp_keepalive_intvl"})}),(0,r.jsx)(n.th,{children:(0,r.jsx)(n.strong,{children:"tcp_keepalive_probes"})}),(0,r.jsx)(n.th,{children:(0,r.jsx)(n.strong,{children:"tcp_retries2"})}),(0,r.jsx)(n.th,{children:(0,r.jsx)(n.strong,{children:"Reasoning & Trade-offs"})})]})}),(0,r.jsxs)(n.tbody,{children:[(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.strong,{children:"Public API Gateway (high concurrent clients)"})}),(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"15"})}),(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"30"})}),(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"10"})}),(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"3"})}),(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"5"})}),(0,r.jsx)(n.td,{children:"Quick cleanup of dead/idle connections to save resources, while allowing short keep-alives for API clients."})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.strong,{children:"Internal microservices (low latency, stable network)"})}),(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"10"})}),(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"60"})}),(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"20"})}),(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"3"})}),(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"3"})}),(0,r.jsx)(n.td,{children:"Fast connection recycling, rare need for keep-alives due to low latency, prioritizing efficiency."})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.strong,{children:"Mobile-heavy client traffic (prone to network drops)"})}),(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"30"})}),(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"120"})}),(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"20"})}),(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"5"})}),(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"7"})}),(0,r.jsx)(n.td,{children:"More lenient timeouts to account for intermittent mobile network instability; avoid prematurely dropping clients."})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.strong,{children:"WebSocket / long-lived connections (chat apps, gaming)"})}),(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"60"})}),(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"300"})}),(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"60"})}),(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"5"})}),(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"8"})}),(0,r.jsx)(n.td,{children:"Allow long idle connections; keep-alives to detect dead connections without cutting active clients abruptly."})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.strong,{children:"DDoS-prone public proxy (security-focused)"})}),(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"5"})}),(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"30"})}),(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"5"})}),(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"2"})}),(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"3"})}),(0,r.jsx)(n.td,{children:"Aggressive timeouts to prevent resource exhaustion; fast cleanup of potentially malicious connections."})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.strong,{children:"IoT Device Communication (sporadic, unstable)"})}),(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"30"})}),(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"180"})}),(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"30"})}),(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"4"})}),(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"6"})}),(0,r.jsx)(n.td,{children:"Longer keep-alives to maintain connection with low-power devices, balanced with cleanup to avoid idle hangs."})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.strong,{children:"Slow clients behind proxies (corporate clients, satellite)"})}),(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"20"})}),(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"150"})}),(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"30"})}),(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"4"})}),(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"6"})}),(0,r.jsx)(n.td,{children:"Moderate timeouts to handle slow networks without dropping legitimate users."})]})]})]}),"\n",(0,r.jsx)(n.hr,{}),"\n",(0,r.jsxs)(n.h3,{id:"-legend-quick-reference",children:["\u2705 ",(0,r.jsx)(n.strong,{children:"Legend (Quick Reference)"})]}),"\n",(0,r.jsxs)(n.table,{children:[(0,r.jsx)(n.thead,{children:(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.th,{children:(0,r.jsx)(n.strong,{children:"Parameter"})}),(0,r.jsx)(n.th,{children:(0,r.jsx)(n.strong,{children:"Purpose"})})]})}),(0,r.jsxs)(n.tbody,{children:[(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"tcp_fin_timeout"})}),(0,r.jsx)(n.td,{children:"How long to keep closing connection in FIN state."})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"tcp_keepalive_time"})}),(0,r.jsx)(n.td,{children:"Idle time before sending first keep-alive probe."})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"tcp_keepalive_intvl"})}),(0,r.jsx)(n.td,{children:"Interval between successive keep-alive probes."})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"tcp_keepalive_probes"})}),(0,r.jsx)(n.td,{children:"Number of probes before dropping connection."})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"tcp_retries2"})}),(0,r.jsx)(n.td,{children:"Max TCP retransmissions before giving up."})]})]})]}),"\n",(0,r.jsx)(n.hr,{}),"\n",(0,r.jsxs)(n.h3,{id:"\ufe0f-notes",children:["\u2699\ufe0f ",(0,r.jsx)(n.strong,{children:"Notes:"})]}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Lower timeouts"}),": Free up resources quickly, but risk dropping slow/legit connections."]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Higher timeouts"}),": Improve user experience over slow networks but consume more resources."]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Keep-alive settings"}),": Essential for long-lived or idle connections to detect dead peers."]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Retries"}),": Trade-off between network resilience and resource use."]}),"\n"]}),"\n",(0,r.jsx)(n.hr,{}),"\n",(0,r.jsxs)(n.p,{children:["If you want, I can prepare a ",(0,r.jsxs)(n.strong,{children:[(0,r.jsx)(n.code,{children:"sysctl.conf"})," file snippet"]})," based on any of these scenarios for direct use. Let me know! \ud83d\ude80"]}),"\n",(0,r.jsx)(n.hr,{}),"\n",(0,r.jsxs)(n.p,{children:["source: ",(0,r.jsx)(n.a,{href:"https://github.com/brettwooldridge/HikariCP/wiki/Down-the-Rabbit-Hole",children:"https://github.com/brettwooldridge/HikariCP/wiki/Down-the-Rabbit-Hole"})]}),"\n",(0,r.jsx)(n.hr,{})]})}function a(e={}){const{wrapper:n}={...(0,i.R)(),...e.components};return n?(0,r.jsx)(n,{...e,children:(0,r.jsx)(h,{...e})}):h(e)}},8453:(e,n,t)=>{t.d(n,{R:()=>c,x:()=>o});var s=t(6540);const r={},i=s.createContext(r);function c(e){const n=s.useContext(i);return s.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function o(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(r):e.components||r:c(e.components),s.createElement(i.Provider,{value:n},e.children)}},3888:e=>{e.exports=JSON.parse('{"permalink":"/byte_vault/blog/connection-pooling-in-depth","source":"@site/blog/2025-03-13-connection-pooling.mdx","title":"Connection Pooling - in Depth","description":"Here\u2019s a Markdown table that maps real-life reverse proxy scenarios to recommended TCP tuning parameters for optimal performance and security:","date":"2025-03-13T00:00:00.000Z","tags":[{"inline":false,"label":"Connection","permalink":"/byte_vault/blog/tags/connection","description":"Network connections"},{"inline":false,"label":"Database","permalink":"/byte_vault/blog/tags/database","description":"Database systems"},{"inline":false,"label":"Network","permalink":"/byte_vault/blog/tags/network","description":"Networking concepts"}],"readingTime":2.105,"hasTruncateMarker":false,"authors":[{"name":"Abhishek Tripathi","title":"Curiosity brings awareness.","url":"https://github.com/TwistingTwists","page":{"permalink":"/byte_vault/blog/authors/abeeshake"},"socials":{"x":"https://x.com/twistin456","github":"https://github.com/TwistingTwists"},"imageURL":"https://github.com/TwistingTwists.png","key":"abeeshake"}],"frontMatter":{"slug":"connection-pooling-in-depth","title":"Connection Pooling - in Depth","date":"2025-03-13T00:00:00.000Z","authors":["abeeshake"],"tags":["connection","database","network"],"draft":false},"unlisted":false,"prevItem":{"title":"Writing","permalink":"/byte_vault/blog/writing"},"nextItem":{"title":"Reliable Structured Outputs with LLMs","permalink":"/byte_vault/blog/reliable-structured-outputs-with-llms"}}')}}]);